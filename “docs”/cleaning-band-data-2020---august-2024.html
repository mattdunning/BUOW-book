<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Cleaning Band Data 2020 - August 2024 | Combining export files to send to SQL</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Cleaning Band Data 2020 - August 2024 | Combining export files to send to SQL" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Cleaning Band Data 2020 - August 2024 | Combining export files to send to SQL" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Matthew Dunning" />


<meta name="date" content="2024-12-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cleaning-band-data-2000-2019.html"/>
<link rel="next" href="cleaning-capture-data-2000-2019.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>1.1</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html"><i class="fa fa-check"></i><b>2</b> Cleaning Band Data 2000-2019</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html#cleaning-band"><i class="fa fa-check"></i><b>2.1</b> Cleaning Band</a></li>
<li class="chapter" data-level="2.2" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html#add-hyphens-in-the-correct-locations"><i class="fa fa-check"></i><b>2.3</b> Add hyphens in the correct locations</a></li>
<li class="chapter" data-level="2.4" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html#fix-some-capitalization-issues"><i class="fa fa-check"></i><b>2.4</b> Fix some capitalization issues</a></li>
<li class="chapter" data-level="2.5" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html#proofing-resights"><i class="fa fa-check"></i><b>2.5</b> Proofing resights</a></li>
<li class="chapter" data-level="2.6" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html#clean-the-sex-column"><i class="fa fa-check"></i><b>2.6</b> Clean the sex column</a></li>
<li class="chapter" data-level="2.7" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html#now-clean-the-usgs-band-info"><i class="fa fa-check"></i><b>2.7</b> Now clean the USGS band info</a></li>
<li class="chapter" data-level="2.8" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html#acraft-specific-cleaning"><i class="fa fa-check"></i><b>2.8</b> ACRAFT specific cleaning</a></li>
<li class="chapter" data-level="2.9" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html#color-band-sorting"><i class="fa fa-check"></i><b>2.9</b> Color band sorting</a></li>
<li class="chapter" data-level="2.10" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html#get-the-rest-of-the-bands-that-have-neither-acraft-nor-color-bands"><i class="fa fa-check"></i><b>2.10</b> Get the rest of the bands that have neither ACRAFT nor Color bands</a></li>
<li class="chapter" data-level="2.11" data-path="cleaning-band-data-2000-2019.html"><a href="cleaning-band-data-2000-2019.html#finally-remove-all-unneccessary-dataframes-and-objects-to-keep-environment-tidy"><i class="fa fa-check"></i><b>2.11</b> Finally remove all unneccessary dataframes and objects to keep environment tidy</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cleaning-band-data-2020---august-2024.html"><a href="cleaning-band-data-2020---august-2024.html"><i class="fa fa-check"></i><b>3</b> Cleaning Band Data 2020 - August 2024</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cleaning-band-data-2020---august-2024.html"><a href="cleaning-band-data-2020---august-2024.html#install-and-load-packages"><i class="fa fa-check"></i><b>3.1</b> Install and load packages</a></li>
<li class="chapter" data-level="3.2" data-path="cleaning-band-data-2020---august-2024.html"><a href="cleaning-band-data-2020---august-2024.html#set-directory-and-load-data"><i class="fa fa-check"></i><b>3.2</b> Set directory and load data</a></li>
<li class="chapter" data-level="3.3" data-path="cleaning-band-data-2020---august-2024.html"><a href="cleaning-band-data-2020---august-2024.html#add-hyphens-where-needed"><i class="fa fa-check"></i><b>3.3</b> Add hyphens where needed</a></li>
<li class="chapter" data-level="3.4" data-path="cleaning-band-data-2020---august-2024.html"><a href="cleaning-band-data-2020---august-2024.html#move-colors-into-correct-columns"><i class="fa fa-check"></i><b>3.4</b> Move colors into correct columns</a></li>
<li class="chapter" data-level="3.5" data-path="cleaning-band-data-2020---august-2024.html"><a href="cleaning-band-data-2020---august-2024.html#proof-and-edit-the-sex-column"><i class="fa fa-check"></i><b>3.5</b> Proof and Edit the sex column</a></li>
<li class="chapter" data-level="3.6" data-path="cleaning-band-data-2020---august-2024.html"><a href="cleaning-band-data-2020---august-2024.html#export-data-and-remove-objects"><i class="fa fa-check"></i><b>3.6</b> Export data and remove objects</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html"><i class="fa fa-check"></i><b>4</b> Cleaning Capture Data 2000-2019</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#load-libraries"><i class="fa fa-check"></i><b>4.1</b> Load libraries</a></li>
<li class="chapter" data-level="4.2" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#set-directory-and-load-data-1"><i class="fa fa-check"></i><b>4.2</b> Set directory and load data</a></li>
<li class="chapter" data-level="4.3" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#fix-the-hyphens"><i class="fa fa-check"></i><b>4.3</b> Fix the hyphens</a></li>
<li class="chapter" data-level="4.4" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#convert-latitude-and-longitude-from-utm"><i class="fa fa-check"></i><b>4.4</b> Convert latitude and longitude from UTM</a></li>
<li class="chapter" data-level="4.5" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#filter-and-clean-data"><i class="fa fa-check"></i><b>4.5</b> Filter and clean data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#filter-and-clean-parasite-column"><i class="fa fa-check"></i><b>4.5.1</b> Filter and clean parasite column</a></li>
<li class="chapter" data-level="4.5.2" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#filter-and-clean-brood-patch-column"><i class="fa fa-check"></i><b>4.5.2</b> Filter and clean brood patch column</a></li>
<li class="chapter" data-level="4.5.3" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#filter-and-clean-sex-column"><i class="fa fa-check"></i><b>4.5.3</b> Filter and clean sex column</a></li>
<li class="chapter" data-level="4.5.4" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#filter-and-clean-hy-day-old-age"><i class="fa fa-check"></i><b>4.5.4</b> Filter and clean HY day old age</a></li>
<li class="chapter" data-level="4.5.5" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#standardize-values"><i class="fa fa-check"></i><b>4.5.5</b> Standardize values</a></li>
<li class="chapter" data-level="4.5.6" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#change-site-to-abbreviations-to-full-names"><i class="fa fa-check"></i><b>4.5.6</b> Change site to abbreviations to full names</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#prepare-data-for-export"><i class="fa fa-check"></i><b>4.6</b> Prepare data for export</a></li>
<li class="chapter" data-level="4.7" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#cleaning-dobule-entried-rows"><i class="fa fa-check"></i><b>4.7</b> Cleaning dobule entried rows</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#import-data"><i class="fa fa-check"></i><b>4.7.1</b> Import Data</a></li>
<li class="chapter" data-level="4.7.2" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#clean-data"><i class="fa fa-check"></i><b>4.7.2</b> Clean data</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="cleaning-capture-data-2000-2019.html"><a href="cleaning-capture-data-2000-2019.html#prepare-data-for-export-1"><i class="fa fa-check"></i><b>4.8</b> Prepare data for export</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cleaning-capture-data-2020---august-2024.html"><a href="cleaning-capture-data-2020---august-2024.html"><i class="fa fa-check"></i><b>5</b> Cleaning Capture Data 2020 - August 2024</a>
<ul>
<li class="chapter" data-level="5.1" data-path="cleaning-capture-data-2020---august-2024.html"><a href="cleaning-capture-data-2020---august-2024.html#load-packages-and-data"><i class="fa fa-check"></i><b>5.1</b> Load packages and data</a></li>
<li class="chapter" data-level="5.2" data-path="cleaning-capture-data-2020---august-2024.html"><a href="cleaning-capture-data-2020---august-2024.html#preapare-data"><i class="fa fa-check"></i><b>5.2</b> Preapare data</a></li>
<li class="chapter" data-level="5.3" data-path="cleaning-capture-data-2020---august-2024.html"><a href="cleaning-capture-data-2020---august-2024.html#latitude-and-longitude-from-utms"><i class="fa fa-check"></i><b>5.3</b> Latitude and Longitude from UTMs</a></li>
<li class="chapter" data-level="5.4" data-path="cleaning-capture-data-2020---august-2024.html"><a href="cleaning-capture-data-2020---august-2024.html#cleaning-data"><i class="fa fa-check"></i><b>5.4</b> Cleaning data</a></li>
<li class="chapter" data-level="5.5" data-path="cleaning-capture-data-2020---august-2024.html"><a href="cleaning-capture-data-2020---august-2024.html#export-data"><i class="fa fa-check"></i><b>5.5</b> Export Data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="create-sqllite-database-structure.html"><a href="create-sqllite-database-structure.html"><i class="fa fa-check"></i><b>6</b> Create SQLlite Database Structure</a>
<ul>
<li class="chapter" data-level="6.1" data-path="create-sqllite-database-structure.html"><a href="create-sqllite-database-structure.html#create-sqllite-database"><i class="fa fa-check"></i><b>6.1</b> Create SQLlite Database</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="import-buow-data-into-sqllite.html"><a href="import-buow-data-into-sqllite.html"><i class="fa fa-check"></i><b>7</b> Import BUOW data into SQLlite</a>
<ul>
<li class="chapter" data-level="7.1" data-path="import-buow-data-into-sqllite.html"><a href="import-buow-data-into-sqllite.html#combine-all-band-tables"><i class="fa fa-check"></i><b>7.1</b> Combine All Band Tables</a></li>
<li class="chapter" data-level="7.2" data-path="import-buow-data-into-sqllite.html"><a href="import-buow-data-into-sqllite.html#combine-all-capture-tables"><i class="fa fa-check"></i><b>7.2</b> Combine All Capture Tables</a></li>
<li class="chapter" data-level="7.3" data-path="import-buow-data-into-sqllite.html"><a href="import-buow-data-into-sqllite.html#load-sites-table"><i class="fa fa-check"></i><b>7.3</b> Load Sites table</a></li>
<li class="chapter" data-level="7.4" data-path="import-buow-data-into-sqllite.html"><a href="import-buow-data-into-sqllite.html#start-import-to-sql"><i class="fa fa-check"></i><b>7.4</b> Start import to SQL</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="import-buow-data-into-sqllite.html"><a href="import-buow-data-into-sqllite.html#import-band-table"><i class="fa fa-check"></i><b>7.4.1</b> Import band table</a></li>
<li class="chapter" data-level="7.4.2" data-path="import-buow-data-into-sqllite.html"><a href="import-buow-data-into-sqllite.html#import-capture-table"><i class="fa fa-check"></i><b>7.4.2</b> Import Capture Table</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Combining export files to send to SQL</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cleaning-band-data-2020---august-2024" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Cleaning Band Data 2020 - August 2024<a href="cleaning-band-data-2020---august-2024.html#cleaning-band-data-2020---august-2024" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="install-and-load-packages" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Install and load packages<a href="cleaning-band-data-2020---august-2024.html#install-and-load-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="cleaning-band-data-2020---august-2024.html#cb16-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb16-2"><a href="cleaning-band-data-2020---august-2024.html#cb16-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;readxl&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="cleaning-band-data-2020---august-2024.html#cb17-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb17-2"><a href="cleaning-band-data-2020---august-2024.html#cb17-2" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code></pre></div>
</div>
<div id="set-directory-and-load-data" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Set directory and load data<a href="cleaning-band-data-2020---august-2024.html#set-directory-and-load-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="cleaning-band-data-2020---august-2024.html#cb18-1" tabindex="-1"></a> <span class="fu">setwd</span>(<span class="st">&quot;~/BUOW_Migration-Maps/data&quot;</span>)</span>
<span id="cb18-2"><a href="cleaning-band-data-2020---august-2024.html#cb18-2" tabindex="-1"></a>BUOW <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;RecentBUOWDataAdditions.xlsx&quot;</span>)</span></code></pre></div>
<p>Now select columns needed for cleaning</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="cleaning-band-data-2020---august-2024.html#cb19-1" tabindex="-1"></a>bands <span class="ot">&lt;-</span> <span class="fu">select</span>(BUOW, band, right_top, right_bottom, left_top, left_bottom,</span>
<span id="cb19-2"><a href="cleaning-band-data-2020---august-2024.html#cb19-2" tabindex="-1"></a>                BandCombo, sex)</span></code></pre></div>
</div>
<div id="add-hyphens-where-needed" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Add hyphens where needed<a href="cleaning-band-data-2020---august-2024.html#add-hyphens-where-needed" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="cleaning-band-data-2020---august-2024.html#cb20-1" tabindex="-1"></a>criteria1 <span class="ot">&lt;-</span> <span class="st">&quot;934&quot;</span> <span class="co">#some bands already had a dash so now there is --</span></span>
<span id="cb20-2"><a href="cleaning-band-data-2020---august-2024.html#cb20-2" tabindex="-1"></a>criteria2 <span class="ot">&lt;-</span> <span class="st">&quot;914&quot;</span></span>
<span id="cb20-3"><a href="cleaning-band-data-2020---august-2024.html#cb20-3" tabindex="-1"></a>criteria3 <span class="ot">&lt;-</span> <span class="st">&quot;804&quot;</span></span>
<span id="cb20-4"><a href="cleaning-band-data-2020---august-2024.html#cb20-4" tabindex="-1"></a>criteriax <span class="ot">&lt;-</span> <span class="fu">c</span>(criteria1, criteria2, criteria3)</span>
<span id="cb20-5"><a href="cleaning-band-data-2020---august-2024.html#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="cleaning-band-data-2020---august-2024.html#cb20-6" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> bands<span class="sc">%&gt;%</span> </span>
<span id="cb20-7"><a href="cleaning-band-data-2020---august-2024.html#cb20-7" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">band =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-8"><a href="cleaning-band-data-2020---august-2024.html#cb20-8" tabindex="-1"></a>  <span class="fu">substr</span>(band, <span class="dv">1</span>, <span class="dv">3</span>) <span class="sc">%in%</span> criteriax <span class="sc">~</span> {</span>
<span id="cb20-9"><a href="cleaning-band-data-2020---august-2024.html#cb20-9" tabindex="-1"></a>    <span class="co"># Remove existing hyphen if it exists</span></span>
<span id="cb20-10"><a href="cleaning-band-data-2020---august-2024.html#cb20-10" tabindex="-1"></a>    clean_band <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;-&quot;</span>, <span class="st">&quot;&quot;</span>, band)</span>
<span id="cb20-11"><a href="cleaning-band-data-2020---august-2024.html#cb20-11" tabindex="-1"></a>    <span class="co"># Ensure you&#39;re using the clean version</span></span>
<span id="cb20-12"><a href="cleaning-band-data-2020---august-2024.html#cb20-12" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="fu">substr</span>(clean_band, <span class="dv">1</span>, <span class="dv">3</span>), <span class="st">&quot;-&quot;</span>, <span class="fu">substr</span>(clean_band, <span class="dv">4</span>, <span class="fu">nchar</span>(clean_band)))</span>
<span id="cb20-13"><a href="cleaning-band-data-2020---august-2024.html#cb20-13" tabindex="-1"></a>  },</span>
<span id="cb20-14"><a href="cleaning-band-data-2020---august-2024.html#cb20-14" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> band)) <span class="co"># Keep original band if no criteria match</span></span>
<span id="cb20-15"><a href="cleaning-band-data-2020---august-2024.html#cb20-15" tabindex="-1"></a></span>
<span id="cb20-16"><a href="cleaning-band-data-2020---august-2024.html#cb20-16" tabindex="-1"></a><span class="fu">remove</span>(criteria1, criteria2, criteria3, criteriax)</span></code></pre></div>
<p>Before moving on we want to add a unique key to each capture event</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="cleaning-band-data-2020---august-2024.html#cb21-1" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="cleaning-band-data-2020---august-2024.html#cb21-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unique_key =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span>     <span class="co"># Adds a sequence number starting from 1</span></span>
<span id="cb21-3"><a href="cleaning-band-data-2020---august-2024.html#cb21-3" tabindex="-1"></a>  <span class="fu">select</span>(unique_key, <span class="fu">everything</span>()) </span></code></pre></div>
</div>
<div id="move-colors-into-correct-columns" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Move colors into correct columns<a href="cleaning-band-data-2020---august-2024.html#move-colors-into-correct-columns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First extract the colors and place in correct columns</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="cleaning-band-data-2020---august-2024.html#cb22-1" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="cleaning-band-data-2020---august-2024.html#cb22-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-3"><a href="cleaning-band-data-2020---august-2024.html#cb22-3" tabindex="-1"></a>    <span class="at">top_left_band =</span> <span class="fu">str_extract</span>(BandCombo, <span class="st">&quot;^[^/]+&quot;</span>),                          <span class="co"># Extract top left part (before first &quot;/&quot;)</span></span>
<span id="cb22-4"><a href="cleaning-band-data-2020---august-2024.html#cb22-4" tabindex="-1"></a>    <span class="at">bottom_left_band =</span> <span class="fu">str_extract</span>(BandCombo, <span class="st">&quot;(?&lt;=/)[^:]+&quot;</span>),                   <span class="co"># Extract bottom left part (between &quot;/&quot; and &quot;:&quot;)</span></span>
<span id="cb22-5"><a href="cleaning-band-data-2020---august-2024.html#cb22-5" tabindex="-1"></a>    <span class="at">top_right_band =</span> <span class="fu">str_extract</span>(BandCombo, <span class="st">&quot;(?&lt;=:)[^/]+&quot;</span>),                     <span class="co"># Extract top right part (between &quot;:&quot; and &quot;/&quot;)</span></span>
<span id="cb22-6"><a href="cleaning-band-data-2020---august-2024.html#cb22-6" tabindex="-1"></a>    <span class="at">bottom_right_band =</span> <span class="fu">str_extract</span>(BandCombo, <span class="st">&quot;(?&lt;=/)[^/]+$&quot;</span>)                  <span class="co"># Extract bottom right part (after last &quot;/&quot;)</span></span>
<span id="cb22-7"><a href="cleaning-band-data-2020---august-2024.html#cb22-7" tabindex="-1"></a>  )</span></code></pre></div>
<p>Next only select bands that have a color combo</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="cleaning-band-data-2020---august-2024.html#cb23-1" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="cleaning-band-data-2020---august-2024.html#cb23-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">right_top =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(right_top), top_right_band, right_top),</span>
<span id="cb23-3"><a href="cleaning-band-data-2020---august-2024.html#cb23-3" tabindex="-1"></a>         <span class="at">right_bottom =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(right_bottom), bottom_right_band, right_bottom),</span>
<span id="cb23-4"><a href="cleaning-band-data-2020---august-2024.html#cb23-4" tabindex="-1"></a>         <span class="at">left_top =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(left_top), top_left_band, left_top),</span>
<span id="cb23-5"><a href="cleaning-band-data-2020---august-2024.html#cb23-5" tabindex="-1"></a>         <span class="at">left_bottom =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(left_bottom), bottom_left_band, left_bottom))</span></code></pre></div>
<p>Next change the abbreviations to full spelling of colors</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="cleaning-band-data-2020---august-2024.html#cb24-1" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="cleaning-band-data-2020---august-2024.html#cb24-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-3"><a href="cleaning-band-data-2020---august-2024.html#cb24-3" tabindex="-1"></a>    <span class="at">left_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Re&quot;</span>, <span class="st">&quot;Red&quot;</span>, left_top),</span>
<span id="cb24-4"><a href="cleaning-band-data-2020---august-2024.html#cb24-4" tabindex="-1"></a>    <span class="at">left_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;NB&quot;</span>, <span class="st">&quot;No Band&quot;</span>, left_top),</span>
<span id="cb24-5"><a href="cleaning-band-data-2020---august-2024.html#cb24-5" tabindex="-1"></a>    <span class="at">left_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Bk&quot;</span>, <span class="st">&quot;Black&quot;</span>, left_top),</span>
<span id="cb24-6"><a href="cleaning-band-data-2020---august-2024.html#cb24-6" tabindex="-1"></a>    <span class="at">left_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Wh&quot;</span>, <span class="st">&quot;White&quot;</span>, left_top),</span>
<span id="cb24-7"><a href="cleaning-band-data-2020---august-2024.html#cb24-7" tabindex="-1"></a>    <span class="at">left_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Ye&quot;</span>, <span class="st">&quot;Yellow&quot;</span>, left_top),</span>
<span id="cb24-8"><a href="cleaning-band-data-2020---august-2024.html#cb24-8" tabindex="-1"></a>    <span class="at">left_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;MBl&quot;</span>, <span class="st">&quot;Medium Blue&quot;</span>, left_top),</span>
<span id="cb24-9"><a href="cleaning-band-data-2020---august-2024.html#cb24-9" tabindex="-1"></a>    <span class="at">left_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;MGr&quot;</span>, <span class="st">&quot;Medium Green&quot;</span>, left_top),</span>
<span id="cb24-10"><a href="cleaning-band-data-2020---august-2024.html#cb24-10" tabindex="-1"></a>    <span class="at">left_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Or&quot;</span>, <span class="st">&quot;Orange&quot;</span>, left_top),</span>
<span id="cb24-11"><a href="cleaning-band-data-2020---august-2024.html#cb24-11" tabindex="-1"></a>    <span class="at">left_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;LBl&quot;</span>, <span class="st">&quot;Light Blue&quot;</span>, left_top),</span>
<span id="cb24-12"><a href="cleaning-band-data-2020---august-2024.html#cb24-12" tabindex="-1"></a>    <span class="at">left_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Gy&quot;</span>, <span class="st">&quot;Gray&quot;</span>, left_top),</span>
<span id="cb24-13"><a href="cleaning-band-data-2020---august-2024.html#cb24-13" tabindex="-1"></a>    <span class="at">left_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;AL&quot;</span>, <span class="st">&quot;USGS&quot;</span>, left_top)</span>
<span id="cb24-14"><a href="cleaning-band-data-2020---august-2024.html#cb24-14" tabindex="-1"></a>  )</span>
<span id="cb24-15"><a href="cleaning-band-data-2020---august-2024.html#cb24-15" tabindex="-1"></a></span>
<span id="cb24-16"><a href="cleaning-band-data-2020---august-2024.html#cb24-16" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href="cleaning-band-data-2020---august-2024.html#cb24-17" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-18"><a href="cleaning-band-data-2020---august-2024.html#cb24-18" tabindex="-1"></a>    <span class="at">right_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Re&quot;</span>, <span class="st">&quot;Red&quot;</span>, right_top),</span>
<span id="cb24-19"><a href="cleaning-band-data-2020---august-2024.html#cb24-19" tabindex="-1"></a>    <span class="at">right_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;NB&quot;</span>, <span class="st">&quot;No Band&quot;</span>, right_top),</span>
<span id="cb24-20"><a href="cleaning-band-data-2020---august-2024.html#cb24-20" tabindex="-1"></a>    <span class="at">right_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Bk&quot;</span>, <span class="st">&quot;Black&quot;</span>, right_top),</span>
<span id="cb24-21"><a href="cleaning-band-data-2020---august-2024.html#cb24-21" tabindex="-1"></a>    <span class="at">right_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Wh&quot;</span>, <span class="st">&quot;White&quot;</span>, right_top),</span>
<span id="cb24-22"><a href="cleaning-band-data-2020---august-2024.html#cb24-22" tabindex="-1"></a>    <span class="at">right_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Ye&quot;</span>, <span class="st">&quot;Yellow&quot;</span>, right_top),</span>
<span id="cb24-23"><a href="cleaning-band-data-2020---august-2024.html#cb24-23" tabindex="-1"></a>    <span class="at">right_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;MBl&quot;</span>, <span class="st">&quot;Medium Blue&quot;</span>, right_top),</span>
<span id="cb24-24"><a href="cleaning-band-data-2020---august-2024.html#cb24-24" tabindex="-1"></a>    <span class="at">right_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;MGr&quot;</span>, <span class="st">&quot;Medium Green&quot;</span>, right_top),</span>
<span id="cb24-25"><a href="cleaning-band-data-2020---august-2024.html#cb24-25" tabindex="-1"></a>    <span class="at">right_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Or&quot;</span>, <span class="st">&quot;Orange&quot;</span>, right_top),</span>
<span id="cb24-26"><a href="cleaning-band-data-2020---august-2024.html#cb24-26" tabindex="-1"></a>    <span class="at">right_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;LBl&quot;</span>, <span class="st">&quot;Light Blue&quot;</span>, right_top),</span>
<span id="cb24-27"><a href="cleaning-band-data-2020---august-2024.html#cb24-27" tabindex="-1"></a>    <span class="at">right_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;Gy&quot;</span>, <span class="st">&quot;Gray&quot;</span>, right_top),</span>
<span id="cb24-28"><a href="cleaning-band-data-2020---august-2024.html#cb24-28" tabindex="-1"></a>    <span class="at">right_top =</span> <span class="fu">gsub</span>(<span class="st">&quot;AL&quot;</span>, <span class="st">&quot;USGS&quot;</span>, right_top)</span>
<span id="cb24-29"><a href="cleaning-band-data-2020---august-2024.html#cb24-29" tabindex="-1"></a>  )</span>
<span id="cb24-30"><a href="cleaning-band-data-2020---august-2024.html#cb24-30" tabindex="-1"></a></span>
<span id="cb24-31"><a href="cleaning-band-data-2020---august-2024.html#cb24-31" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span></span>
<span id="cb24-32"><a href="cleaning-band-data-2020---august-2024.html#cb24-32" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-33"><a href="cleaning-band-data-2020---august-2024.html#cb24-33" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Re&quot;</span>, <span class="st">&quot;Red&quot;</span>, left_bottom),</span>
<span id="cb24-34"><a href="cleaning-band-data-2020---august-2024.html#cb24-34" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;NB&quot;</span>, <span class="st">&quot;No Band&quot;</span>, left_bottom),</span>
<span id="cb24-35"><a href="cleaning-band-data-2020---august-2024.html#cb24-35" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Bk&quot;</span>, <span class="st">&quot;Black&quot;</span>, left_bottom),</span>
<span id="cb24-36"><a href="cleaning-band-data-2020---august-2024.html#cb24-36" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Wh&quot;</span>, <span class="st">&quot;White&quot;</span>, left_bottom),</span>
<span id="cb24-37"><a href="cleaning-band-data-2020---august-2024.html#cb24-37" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Ye&quot;</span>, <span class="st">&quot;Yellow&quot;</span>, left_bottom),</span>
<span id="cb24-38"><a href="cleaning-band-data-2020---august-2024.html#cb24-38" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;MBl&quot;</span>, <span class="st">&quot;Medium Blue&quot;</span>, left_bottom),</span>
<span id="cb24-39"><a href="cleaning-band-data-2020---august-2024.html#cb24-39" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;MGr&quot;</span>, <span class="st">&quot;Medium Green&quot;</span>, left_bottom),</span>
<span id="cb24-40"><a href="cleaning-band-data-2020---august-2024.html#cb24-40" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Or&quot;</span>, <span class="st">&quot;Orange&quot;</span>, left_bottom),</span>
<span id="cb24-41"><a href="cleaning-band-data-2020---august-2024.html#cb24-41" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;LBl&quot;</span>, <span class="st">&quot;Light Blue&quot;</span>, left_bottom),</span>
<span id="cb24-42"><a href="cleaning-band-data-2020---august-2024.html#cb24-42" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Gy&quot;</span>, <span class="st">&quot;Gray&quot;</span>, left_bottom),</span>
<span id="cb24-43"><a href="cleaning-band-data-2020---august-2024.html#cb24-43" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;ACGr&quot;</span>, <span class="st">&quot;ACRAFT Green&quot;</span>, left_bottom),</span>
<span id="cb24-44"><a href="cleaning-band-data-2020---august-2024.html#cb24-44" tabindex="-1"></a>    <span class="at">left_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;AL&quot;</span>, <span class="st">&quot;USGS&quot;</span>, left_bottom)</span>
<span id="cb24-45"><a href="cleaning-band-data-2020---august-2024.html#cb24-45" tabindex="-1"></a>  )</span>
<span id="cb24-46"><a href="cleaning-band-data-2020---august-2024.html#cb24-46" tabindex="-1"></a></span>
<span id="cb24-47"><a href="cleaning-band-data-2020---august-2024.html#cb24-47" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span></span>
<span id="cb24-48"><a href="cleaning-band-data-2020---august-2024.html#cb24-48" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-49"><a href="cleaning-band-data-2020---august-2024.html#cb24-49" tabindex="-1"></a>    <span class="at">right_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Re&quot;</span>, <span class="st">&quot;Red&quot;</span>, right_bottom),</span>
<span id="cb24-50"><a href="cleaning-band-data-2020---august-2024.html#cb24-50" tabindex="-1"></a>    <span class="at">right_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;NB&quot;</span>, <span class="st">&quot;No Band&quot;</span>, right_bottom),</span>
<span id="cb24-51"><a href="cleaning-band-data-2020---august-2024.html#cb24-51" tabindex="-1"></a>    <span class="at">right_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Bk&quot;</span>, <span class="st">&quot;Black&quot;</span>, right_bottom),</span>
<span id="cb24-52"><a href="cleaning-band-data-2020---august-2024.html#cb24-52" tabindex="-1"></a>    <span class="at">right_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Wh&quot;</span>, <span class="st">&quot;White&quot;</span>, right_bottom),</span>
<span id="cb24-53"><a href="cleaning-band-data-2020---august-2024.html#cb24-53" tabindex="-1"></a>    <span class="at">right_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Ye&quot;</span>, <span class="st">&quot;Yellow&quot;</span>, right_bottom),</span>
<span id="cb24-54"><a href="cleaning-band-data-2020---august-2024.html#cb24-54" tabindex="-1"></a>    <span class="at">right_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;MBl&quot;</span>, <span class="st">&quot;Medium Blue&quot;</span>, right_bottom),</span>
<span id="cb24-55"><a href="cleaning-band-data-2020---august-2024.html#cb24-55" tabindex="-1"></a>    <span class="at">right_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;MGr&quot;</span>, <span class="st">&quot;Medium Green&quot;</span>, right_bottom),</span>
<span id="cb24-56"><a href="cleaning-band-data-2020---august-2024.html#cb24-56" tabindex="-1"></a>    <span class="at">right_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Or&quot;</span>, <span class="st">&quot;Orange&quot;</span>, right_bottom),</span>
<span id="cb24-57"><a href="cleaning-band-data-2020---august-2024.html#cb24-57" tabindex="-1"></a>    <span class="at">right_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;LBl&quot;</span>, <span class="st">&quot;Light Blue&quot;</span>, right_bottom),</span>
<span id="cb24-58"><a href="cleaning-band-data-2020---august-2024.html#cb24-58" tabindex="-1"></a>    <span class="at">right_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;Gy&quot;</span>, <span class="st">&quot;Gray&quot;</span>, right_bottom),</span>
<span id="cb24-59"><a href="cleaning-band-data-2020---august-2024.html#cb24-59" tabindex="-1"></a>    <span class="at">right_bottom =</span> <span class="fu">gsub</span>(<span class="st">&quot;AL&quot;</span>, <span class="st">&quot;USGS&quot;</span>, right_bottom)</span>
<span id="cb24-60"><a href="cleaning-band-data-2020---august-2024.html#cb24-60" tabindex="-1"></a>  )</span></code></pre></div>
<p>Remove some columns that are no longer needed</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="cleaning-band-data-2020---august-2024.html#cb25-1" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> <span class="fu">select</span>(practice_band,</span>
<span id="cb25-2"><a href="cleaning-band-data-2020---august-2024.html#cb25-2" tabindex="-1"></a>                        <span class="sc">-</span>BandCombo,</span>
<span id="cb25-3"><a href="cleaning-band-data-2020---august-2024.html#cb25-3" tabindex="-1"></a>                        <span class="sc">-</span>top_right_band,</span>
<span id="cb25-4"><a href="cleaning-band-data-2020---august-2024.html#cb25-4" tabindex="-1"></a>                        <span class="sc">-</span>top_left_band,</span>
<span id="cb25-5"><a href="cleaning-band-data-2020---august-2024.html#cb25-5" tabindex="-1"></a>                        <span class="sc">-</span>bottom_right_band,</span>
<span id="cb25-6"><a href="cleaning-band-data-2020---august-2024.html#cb25-6" tabindex="-1"></a>                        <span class="sc">-</span>bottom_left_band)</span></code></pre></div>
</div>
<div id="proof-and-edit-the-sex-column" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Proof and Edit the sex column<a href="cleaning-band-data-2020---august-2024.html#proof-and-edit-the-sex-column" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First standardize all variables in the sex column</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="cleaning-band-data-2020---august-2024.html#cb26-1" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="cleaning-band-data-2020---august-2024.html#cb26-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">gsub</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;F&quot;</span>, sex),</span>
<span id="cb26-3"><a href="cleaning-band-data-2020---august-2024.html#cb26-3" tabindex="-1"></a>         <span class="at">sex =</span> <span class="fu">gsub</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;M&quot;</span>, sex),</span>
<span id="cb26-4"><a href="cleaning-band-data-2020---august-2024.html#cb26-4" tabindex="-1"></a>         <span class="at">sex =</span> <span class="fu">gsub</span>(<span class="st">&quot;unknown&quot;</span>, <span class="st">&quot;U&quot;</span>, sex),</span>
<span id="cb26-5"><a href="cleaning-band-data-2020---august-2024.html#cb26-5" tabindex="-1"></a>         <span class="at">sex =</span> <span class="fu">gsub</span>(<span class="st">&quot;Unk&quot;</span>, <span class="st">&quot;U&quot;</span>, sex),</span>
<span id="cb26-6"><a href="cleaning-band-data-2020---august-2024.html#cb26-6" tabindex="-1"></a>         <span class="at">sex =</span> <span class="fu">gsub</span>(<span class="st">&quot;J&quot;</span>, <span class="st">&quot;U&quot;</span>, sex),</span>
<span id="cb26-7"><a href="cleaning-band-data-2020---august-2024.html#cb26-7" tabindex="-1"></a>         <span class="at">sex =</span> <span class="fu">gsub</span>(<span class="st">&quot;hy&quot;</span>, <span class="st">&quot;U&quot;</span>, sex),</span>
<span id="cb26-8"><a href="cleaning-band-data-2020---august-2024.html#cb26-8" tabindex="-1"></a>         <span class="at">sex =</span> <span class="fu">gsub</span>(<span class="st">&quot;X&quot;</span>, <span class="cn">NA</span>, sex))</span></code></pre></div>
<p>There are a few cases where there are conflicting sex variables for the same bird. There can only be one value in the band table so all
these values need to be changed to C to reflect this conflict.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="cleaning-band-data-2020---august-2024.html#cb27-1" tabindex="-1"></a><span class="co">#Make all bands that contain both M and F into C. This also makes U a C in these cases.</span></span>
<span id="cb27-2"><a href="cleaning-band-data-2020---august-2024.html#cb27-2" tabindex="-1"></a>bands_with_both <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="cleaning-band-data-2020---august-2024.html#cb27-3" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Filter rows with &quot;M&quot; or &quot;F&quot;</span></span>
<span id="cb27-4"><a href="cleaning-band-data-2020---august-2024.html#cb27-4" tabindex="-1"></a>  <span class="fu">group_by</span>(band) <span class="sc">%&gt;%</span>                <span class="co"># Group by band</span></span>
<span id="cb27-5"><a href="cleaning-band-data-2020---august-2024.html#cb27-5" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n_distinct</span>(sex) <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span>  <span class="co"># Ensure the band contains both &quot;M&quot; and &quot;F&quot;</span></span>
<span id="cb27-6"><a href="cleaning-band-data-2020---august-2024.html#cb27-6" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span>                     <span class="co"># Ungroup after filtering</span></span>
<span id="cb27-7"><a href="cleaning-band-data-2020---august-2024.html#cb27-7" tabindex="-1"></a>  <span class="fu">pull</span>(band)                        <span class="co"># Extract the band names</span></span>
<span id="cb27-8"><a href="cleaning-band-data-2020---august-2024.html#cb27-8" tabindex="-1"></a></span>
<span id="cb27-9"><a href="cleaning-band-data-2020---august-2024.html#cb27-9" tabindex="-1"></a><span class="co"># Step 2: Replace &quot;M&quot;, &quot;F&quot;, and &quot;U&quot; with &quot;C&quot; only for bands that contain both &quot;M&quot; and &quot;F&quot;</span></span>
<span id="cb27-10"><a href="cleaning-band-data-2020---august-2024.html#cb27-10" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="cleaning-band-data-2020---august-2024.html#cb27-11" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-12"><a href="cleaning-band-data-2020---august-2024.html#cb27-12" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-13"><a href="cleaning-band-data-2020---august-2024.html#cb27-13" tabindex="-1"></a>      band <span class="sc">%in%</span> bands_with_both <span class="sc">&amp;</span> sex <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;U&quot;</span>) <span class="sc">~</span> <span class="st">&quot;C&quot;</span>,  <span class="co"># Replace &quot;M&quot;, &quot;F&quot;, &quot;U&quot; with &quot;C&quot; if band has both &quot;M&quot; and &quot;F&quot;</span></span>
<span id="cb27-14"><a href="cleaning-band-data-2020---august-2024.html#cb27-14" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> sex  <span class="co"># Leave all other values unchanged</span></span>
<span id="cb27-15"><a href="cleaning-band-data-2020---august-2024.html#cb27-15" tabindex="-1"></a>    )</span>
<span id="cb27-16"><a href="cleaning-band-data-2020---august-2024.html#cb27-16" tabindex="-1"></a>  )</span></code></pre></div>
<p>There are some cases where a bird was caught as a HY so sex was unknown and it was later
caught as an adult and the sex was known. All these U values should be changed to M or F
because there can only be one value per band.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="cleaning-band-data-2020---august-2024.html#cb28-1" tabindex="-1"></a><span class="co">#changes MU and FU combos to M or F</span></span>
<span id="cb28-2"><a href="cleaning-band-data-2020---august-2024.html#cb28-2" tabindex="-1"></a>bands_with_m_u <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="cleaning-band-data-2020---august-2024.html#cb28-3" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;U&quot;</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Focus on &quot;M&quot; and &quot;U&quot;</span></span>
<span id="cb28-4"><a href="cleaning-band-data-2020---august-2024.html#cb28-4" tabindex="-1"></a>  <span class="fu">group_by</span>(band) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="cleaning-band-data-2020---august-2024.html#cb28-5" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">any</span>(sex <span class="sc">==</span> <span class="st">&quot;M&quot;</span>) <span class="sc">&amp;</span> <span class="fu">any</span>(sex <span class="sc">==</span> <span class="st">&quot;U&quot;</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Band must have both &quot;M&quot; and &quot;U&quot;</span></span>
<span id="cb28-6"><a href="cleaning-band-data-2020---august-2024.html#cb28-6" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="cleaning-band-data-2020---august-2024.html#cb28-7" tabindex="-1"></a>  <span class="fu">pull</span>(band)  <span class="co"># Extract the band names</span></span>
<span id="cb28-8"><a href="cleaning-band-data-2020---august-2024.html#cb28-8" tabindex="-1"></a></span>
<span id="cb28-9"><a href="cleaning-band-data-2020---august-2024.html#cb28-9" tabindex="-1"></a>bands_with_f_u <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="cleaning-band-data-2020---august-2024.html#cb28-10" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;U&quot;</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Focus on &quot;F&quot; and &quot;U&quot;</span></span>
<span id="cb28-11"><a href="cleaning-band-data-2020---august-2024.html#cb28-11" tabindex="-1"></a>  <span class="fu">group_by</span>(band) <span class="sc">%&gt;%</span></span>
<span id="cb28-12"><a href="cleaning-band-data-2020---august-2024.html#cb28-12" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">any</span>(sex <span class="sc">==</span> <span class="st">&quot;F&quot;</span>) <span class="sc">&amp;</span> <span class="fu">any</span>(sex <span class="sc">==</span> <span class="st">&quot;U&quot;</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Band must have both &quot;F&quot; and &quot;U&quot;</span></span>
<span id="cb28-13"><a href="cleaning-band-data-2020---august-2024.html#cb28-13" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="cleaning-band-data-2020---august-2024.html#cb28-14" tabindex="-1"></a>  <span class="fu">pull</span>(band)  <span class="co"># Extract the band names</span></span>
<span id="cb28-15"><a href="cleaning-band-data-2020---august-2024.html#cb28-15" tabindex="-1"></a></span>
<span id="cb28-16"><a href="cleaning-band-data-2020---august-2024.html#cb28-16" tabindex="-1"></a><span class="co"># Step 2: Mutate the sex column to replace &quot;U&quot; with &quot;M&quot; or &quot;F&quot; based on the logic above</span></span>
<span id="cb28-17"><a href="cleaning-band-data-2020---august-2024.html#cb28-17" tabindex="-1"></a>practice_band <span class="ot">&lt;-</span> practice_band <span class="sc">%&gt;%</span></span>
<span id="cb28-18"><a href="cleaning-band-data-2020---august-2024.html#cb28-18" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-19"><a href="cleaning-band-data-2020---august-2024.html#cb28-19" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">case_when</span>(</span>
<span id="cb28-20"><a href="cleaning-band-data-2020---august-2024.html#cb28-20" tabindex="-1"></a>      band <span class="sc">%in%</span> bands_with_m_u <span class="sc">&amp;</span> sex <span class="sc">==</span> <span class="st">&quot;U&quot;</span> <span class="sc">~</span> <span class="st">&quot;M&quot;</span>,  <span class="co"># If band has both &quot;M&quot; and &quot;U&quot;, change &quot;U&quot; to &quot;M&quot;</span></span>
<span id="cb28-21"><a href="cleaning-band-data-2020---august-2024.html#cb28-21" tabindex="-1"></a>      band <span class="sc">%in%</span> bands_with_f_u <span class="sc">&amp;</span> sex <span class="sc">==</span> <span class="st">&quot;U&quot;</span> <span class="sc">~</span> <span class="st">&quot;F&quot;</span>,  <span class="co"># If band has both &quot;F&quot; and &quot;U&quot;, change &quot;U&quot; to &quot;F&quot;</span></span>
<span id="cb28-22"><a href="cleaning-band-data-2020---august-2024.html#cb28-22" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> sex  <span class="co"># Otherwise, keep the original value of sex</span></span>
<span id="cb28-23"><a href="cleaning-band-data-2020---august-2024.html#cb28-23" tabindex="-1"></a>    )</span>
<span id="cb28-24"><a href="cleaning-band-data-2020---august-2024.html#cb28-24" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="export-data-and-remove-objects" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Export data and remove objects<a href="cleaning-band-data-2020---august-2024.html#export-data-and-remove-objects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="cleaning-band-data-2020---august-2024.html#cb29-1" tabindex="-1"></a>export_recentBUOWtable <span class="ot">&lt;-</span> <span class="fu">select</span>(practice_band,</span>
<span id="cb29-2"><a href="cleaning-band-data-2020---august-2024.html#cb29-2" tabindex="-1"></a>                 <span class="at">BUOW_USGS_ID =</span> band,</span>
<span id="cb29-3"><a href="cleaning-band-data-2020---august-2024.html#cb29-3" tabindex="-1"></a>                 <span class="at">top_left_band =</span> left_top,</span>
<span id="cb29-4"><a href="cleaning-band-data-2020---august-2024.html#cb29-4" tabindex="-1"></a>                 <span class="at">bottom_left_band =</span> left_bottom,</span>
<span id="cb29-5"><a href="cleaning-band-data-2020---august-2024.html#cb29-5" tabindex="-1"></a>                 <span class="at">top_right_band =</span> right_top,</span>
<span id="cb29-6"><a href="cleaning-band-data-2020---august-2024.html#cb29-6" tabindex="-1"></a>                 <span class="at">bottom_right_band =</span> right_bottom,</span>
<span id="cb29-7"><a href="cleaning-band-data-2020---august-2024.html#cb29-7" tabindex="-1"></a>                 sex)</span>
<span id="cb29-8"><a href="cleaning-band-data-2020---august-2024.html#cb29-8" tabindex="-1"></a></span>
<span id="cb29-9"><a href="cleaning-band-data-2020---august-2024.html#cb29-9" tabindex="-1"></a><span class="fu">remove</span>(bands, BUOW, practice_band, bands_with_both, bands_with_f_u, bands_with_m_u)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cleaning-band-data-2000-2019.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cleaning-capture-data-2000-2019.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-BandCleaningpt.2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
